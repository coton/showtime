{"version":3,"sources":["main.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"main.js","sourcesContent":["/*global QRCode*/\n\nvar app = app || {};\napp.init = function(){\n    this.bind_upload_event();\n    this.print_qrcode();\n};\n\napp.bind_upload_event = function(){\n    $('#container').dropzone({\n        url: '/artwork/add',\n        clickable: true,\n        maxFilesize: 8,\n        headers: {\n            'X-CSRF-TOKEN': $('meta[name=\"csrf-token\"]').attr('content')\n        },\n        acceptedFiles: 'image/*',\n        init: function() {\n            this.on(\"addedfile\", function(file) {\n                $('#artimg').attr('src', '');\n                $(\".process\").show();\n            });\n\n            this.on('uploadprogress', function(file, rate){\n                $(\".process-rate\").html(Math.floor(rate) + \"%\");\n            });\n\n            this.on('error', function(event, errorMessage, xhr){\n                $(\".process-rate\").html(errorMessage);\n                $(\".process\").hide();\n            });\n\n            this.on('success', function(file, rs) {\n                if(rs && rs.code == 1)\n                {\n                    $('#artimg').attr('src', rs.url);\n                    app.generate_qrcode(rs.qrurl);\n\n                    $(\".process-rate\").html(\"\");\n                }else\n                {\n                    var error_message = \"Upload Failed!\";\n\n                    if(rs && rs.code == 9)\n                    {\n                        app.generate_qrcode(rs.qrurl);\n                        error_message = \"File already exist! Scan the QR Code to check!\";\n                    }\n\n                    $(\".process-rate\").html(error_message);\n                }\n\n                $(\".process\").hide();\n            });\n        }\n\n    });\n};\n\napp.generate_qrcode = function(url){\n    $('#qrcode').html('');\n    var qrcode = new QRCode('qrcode', {\n        width: 200,\n        height: 200}\n    );\n    qrcode.makeCode(url);\n\n    setTimeout(function(){\n        $('#download').attr('href', $('#qrcode img').attr('src'));\n    }, 1000);\n};\n\napp.print_qrcode = function(){\n    $('#print').click(function(){\n        $('#qrcode').printArea();\n    });\n};\n\n\n/*-- tools\n ====================================================== */\napp.tools = function(){};\n\napp.tools.getbaseurl = function(){\n    var url = window.location.href;\n    return url.substring(0, url.lastIndexOf('/') + 1);\n};\n\n\n\n(function(){\n\n    app.init();\n\n})();"],"sourceRoot":"/source/"}